<template>  <div class="onlineList">    <div class="search">      <div class="searchInput">        <span id="sousuoType" @click="showSelectPopup=true">          <popup-picker class="sousuoType_div" :data="typeList" v-model="typeVal" @on-show="onShow" @on-hide="onHide" @on-change="onChange" ></popup-picker>        </span>        <input type='text'  @onfocus="placeholder=''" v-on:input="changeInputHandle" placeholder="搜索" v-model="hotelInfo" autocomplete="off" autocorrect="off" spellcheck="false" autocapitalize="off">      </div>      <span class="confirm" @click="search()">确定</span>    </div>    <scroller :pullup-config="Interface.scrollerUp"              @on-pullup-loading="loadingList"              lock-x              use-pullup              v-model="scroller"              :scrollbarY=true bounce ref="scrollerBottom">      <div class="onlineWrap">        <article>          <!--<group gutter="0">-->          <!--<cell v-for="(item,index) in list" :key="index" :title="item.hotelName" is-link  v-on:mousedown.click="gotoDetail(item.hotelId)" :inline-desc="item.area+' '+datetimeparse(item.createtime,'YYMMDD')+' 上线'"> </cell>-->        <!--</group>-->          <div v-for="(item,index) in list" :key="index" class="item" >             <div> {{item.hotelName}}</div>             <div style=";color: #6f6f6f">{{item.area+' '+datetimeparse(item.createtime,'YYMMDD')+' 上线'}}</div>             <i class="iconfont icon-gengduo" style="position: absolute;right: 0.5rem;top:15%" @click="gotoDetail(item.hotelId)"></i>          </div>        </article>      </div>    </scroller>    <p class="addHotel" @click="addHotel">+ 添加酒店</p>    <!--<SelectPopup :dataList="typelist" :show2="showSelectPopup" @click="showSelectPopup=true" :value2="typeVal"></SelectPopup>-->  </div></template><script> import {mapActions,mapState,mapMutations} from 'vuex' import {Group,Cell,Scroller,PopupPicker} from 'vux' // import SelectPopup from './../../components/Functional/SelectPopup' export default{     data(){         return{             hotelInfo:'',             list:[],             scroller: {pullupStatus: 'default'},             onFetching:false,             offset:0,             limit:15,             listTotal:'',             typeList:[['旅业ID','酒店名称','设备名称','手机号']],             // typeList:[[{             //     name: '2019届5班',             //     value: '1'             // }, {             //     name: '2019届4班',             //     value: '2'             // }]],             typeVal:['酒店名称'],             hotelType:'',             showSelectPopup:false         }     },     computed:{         ...mapState([             'searchHotelId',             'Interface'         ])     },     components:{         Group,         Cell,         Scroller,         PopupPicker     },     watch:{     },     methods:{         ...mapActions([             'goto',             'searchOnlineHotleList',             'searchHotel'         ]),         ...mapMutations([             'SEARCHHOTELID'         ]),         changeInputHandle(){             console.log(44444)             if(this.hotelInfo==''){                 this.offset=0;                 this.initList()             }         },         onShow(){         },         onChange(){         },         onHide(){         },         onChange(){         },         addHotel(){             this.SEARCHHOTELID('');             this.goto('/onlineTool/hotelBasicInfo');         },         gotoDetail(hotelId){             this.goto('/onlineTool/onlineDetail')             this.SEARCHHOTELID(hotelId);         },         searchList(callback,page){             switch (this.typeVal[0]){                 case '旅业ID':                     this.hotelType=1;                     break;                 case '酒店名称':                     this.hotelType=2;                     break;                 case '设备名称':                     this.hotelType=3;                     break;                 case '手机号':                     this.hotelType=4;                     break;             }             if(this.hotelInfo!==''){                 this.searchHotel({                     type:this.hotelType,                     data:{                         "hotelName":this.hotelInfo                     },                     limit:15,                     offset:page,                     onsuccess:callback                 })             }         },         //分页刷新         loadingList(){             if (this.onFetching) {                 console.log ('不能再请求了')                 // do nothing                 return;             } else {                 this.onFetching = true;                 console.log(33)                 setTimeout(() => {                     this.offset=this.offset+15;                     let callback=(body,headers) => {                         this.listTotal=headers.get('x-total-count');                         this.list = [...this.list,...body.data];                         this.scroller.pullupStatus = 'default';                         if(!body.data||body.data.length==0) {                             this.scroller.pullupStatus = 'disabled';                         };                     }                     if(this.hotelInfo!==''){                        this.searchList(callback,this.offset)                     }else {                         this.getList(callback,this.offset);                     }                     //$nextTick是为了数据改变了等待dom渲染后使用                     this.$nextTick(() => {                         this.$refs.scrollerBottom.reset();                     });                     this.onFetching = false;                 }, 500);             }         },         getList(callback,page){             this.searchOnlineHotleList({                 limit:this.limit,                 offset:page,                 onsuccess:callback             })         },         //初始化回调         initCallback(body){             if(!body.data||body.data.length==0) {                 this.scroller.pullupStatus = 'disabled';             };             this.list=(body.data?[...body.data]:[]);         },         //初始化列表         initList(){             this.scroller.pullupStatus = 'enabled';             this.offset=0;             this.getList((body => {                 this.initCallback(body)             }),0)         },         //初始化筛选列表         search(){             this.scroller.pullupStatus = 'enabled';             this.offset=0;             this.searchList((body => {                 this.initCallback(body)             }),0)         },     },     created(){         this.initList()     } }</script><style lang="less" scoped>  @import './index.less';  .onlineList{    .item{      border-bottom: 1px solid #eaeaea;      width: 100%;      padding: 0.6rem 0;      position: relative;    }    .xs-container{      padding-bottom: 3rem;    }    .onlineWrap{      position: relative;      padding-bottom: 100px;      padding-left: 1rem;    }    .icon-gengduo{      color: #9A9A9A;      width: 4rem;      height: 3rem;      text-align: center;      line-height: 3rem;    }  }</style>